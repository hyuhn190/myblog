# ğŸ§‘â€ğŸ’» Django åšå®¢ç³»ç»Ÿé¡¹ç›®æ–‡æ¡£

> ä¸€ä¸ªåŸºäº Django çš„åšå®¢å¹³å°ï¼Œæ”¯æŒç”¨æˆ·ç™»å½•ã€é˜…è¯»è®¡æ•°ç»Ÿè®¡ã€ç¼“å­˜ä¼˜åŒ–ä¸å¼‚æ­¥ä»»åŠ¡å¤„ç†ã€‚

---

## ğŸ“Œ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ **Django åšå®¢ç³»ç»Ÿ**ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒæ¨¡å—ï¼š

- ç”¨æˆ·æ³¨å†Œä¸ç™»å½•
- åšå®¢æ–‡ç« å±•ç¤ºä¸è¯¦æƒ…æŸ¥çœ‹
- é˜…è¯»é‡ç»Ÿè®¡ï¼ˆRedis ç¼“å­˜ + å¼‚æ­¥è½åº“ï¼‰
- ç¼“å­˜å‘½ä¸­ç‡ç›‘æ§
- Celery å®šæ—¶ä»»åŠ¡åŒæ­¥ç¼“å­˜æ•°æ®åˆ°æ•°æ®åº“

è¯¥é¡¹ç›®é€‚ç”¨äºå­¦ä¹  Django Web å¼€å‘ã€ç¼“å­˜ä¼˜åŒ–ã€å¼‚æ­¥ä»»åŠ¡è°ƒåº¦ç­‰å®è·µåœºæ™¯ã€‚

---

## ğŸ§© æ ¸å¿ƒåŠŸèƒ½

### 1. ç”¨æˆ·ç®¡ç†
- æ³¨å†Œ / ç™»å½• / ç™»å‡º
- è‡ªåŠ¨è·³è½¬æ”¯æŒ `?next=` å‚æ•°
- æ³¨å†ŒæˆåŠŸé¡µé¢è‡ªåŠ¨è·³è½¬

> ä½¿ç”¨ Django å†…ç½®è®¤è¯ç³»ç»Ÿï¼Œå®‰å…¨æ€§é«˜ã€‚

### 2. åšå®¢ç³»ç»Ÿ
- å±•ç¤ºæ‰€æœ‰åšå®¢åˆ—è¡¨
- æŸ¥çœ‹å•ç¯‡åšå®¢å†…å®¹
- æ¯ä½ç”¨æˆ·é˜…è¯»æ¬¡æ•°ç‹¬ç«‹ç»Ÿè®¡
- æ€»è®¿é—®é‡ã€ç‹¬ç«‹è®¿å®¢æ•°ã€å½“å‰ç”¨æˆ·é˜…è¯»æ¬¡æ•°å®æ—¶æ˜¾ç¤º

> åŸºäº Django ORM å®ç°ï¼Œç»“åˆ Redis ç¼“å­˜æå‡æ€§èƒ½ã€‚

### 3. é˜…è¯»ç»Ÿè®¡ï¼ˆé«˜æ€§èƒ½è®¾è®¡ï¼‰
- ä½¿ç”¨ Redis ç¼“å­˜è®°å½•é˜…è¯»è¡Œä¸ºï¼ˆ`incr`, `sadd`ï¼‰
- ç»Ÿè®¡ç»´åº¦ï¼š
  - æ€»é˜…è¯»é‡
  - ç‹¬ç«‹è®¿å®¢æ•°ï¼ˆUVï¼‰
  - å½“å‰ç”¨æˆ·é˜…è¯»æ¬¡æ•°
- å®šæœŸé€šè¿‡ Celery åŒæ­¥ç¼“å­˜æ•°æ®åˆ° MySQL æ•°æ®åº“

> é‡‡ç”¨ç¼“å­˜å‰ç½®è®¾è®¡ï¼Œä¿è¯é«˜å¹¶å‘ä¸‹çš„æ€§èƒ½è¡¨ç°ã€‚

### 4. ç¼“å­˜ç›‘æ§
- æä¾›æ¥å£ `/myblogs/stats/` è¿”å›ç¼“å­˜å‘½ä¸­ç‡æ•°æ®
- æ”¯æŒå®šæ—¶æ‰“å°ç¼“å­˜å‘½ä¸­ç‡æ—¥å¿—ï¼ˆé€šè¿‡ [log_cache_stats](file://E:\django\blog\myblog\management\commands\log_cache_stats.py#L0-L0) å‘½ä»¤ï¼‰

### 5. å¼‚æ­¥ä»»åŠ¡
- ä½¿ç”¨ Celery + Redis å®ç°å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
- å®šæ—¶å°† Redis ä¸­çš„é˜…è¯»ç»Ÿè®¡è½åº“è‡³ MySQL


---

## ğŸ“ é¡¹ç›®ç»“æ„æ¦‚è§ˆ

```
blog/
â”œâ”€â”€ blog/              # Django é¡¹ç›®é…ç½®
â”œâ”€â”€ myblog/            # åšå®¢æ ¸å¿ƒåº”ç”¨
â”‚   â”œâ”€â”€ cache/         # ç¼“å­˜å®¢æˆ·ç«¯ä¸ç›‘æ§
â”‚   â”œâ”€â”€ models.py      # Blog ä¸ BlogView æ¨¡å‹
â”‚   â”œâ”€â”€ views.py       # åšå®¢å±•ç¤ºé€»è¾‘
â”‚   â””â”€â”€ services/      # ç¼“å­˜æœåŠ¡è°ƒç”¨å°è£…
â”œâ”€â”€ users/             # ç”¨æˆ·ç›¸å…³æ¨¡å—
â”œâ”€â”€ mycelery/          # Celery å¼‚æ­¥ä»»åŠ¡æ¨¡å—
â””â”€â”€ manage.py
```


---

## âš™ï¸ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | æè¿° |
|------|------|
| Python 3.x | è¯­è¨€åŸºç¡€ |
| Django 5.2 | Web æ¡†æ¶ |
| MySQL | ä¸»æ•°æ®åº“ |
| Redis | ç¼“å­˜ä¸è®¡æ•°å­˜å‚¨ |
| Celery | å¼‚æ­¥ä»»åŠ¡è°ƒåº¦ |
| django-redis | Django Redis ç¼“å­˜é›†æˆ |
| Logging | æ—¥å¿—ç³»ç»Ÿï¼ˆå‘½ä¸­ç‡æ—¥å¿—ï¼‰ |

---

## ğŸ” å®‰å…¨ä¸æƒé™æ§åˆ¶

- åªæœ‰ç™»å½•ç”¨æˆ·æ‰èƒ½æŸ¥çœ‹åšå®¢è¯¦æƒ…
- ç”¨æˆ·ä¿¡æ¯ç”± Django è®¤è¯ç³»ç»Ÿç»Ÿä¸€ç®¡ç†
- æ‰€æœ‰æ“ä½œå‡å…·å¤‡å¼‚å¸¸æ•è·ä¸æ—¥å¿—è®°å½•æœºåˆ¶

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–äº®ç‚¹

- Redis ç¼“å­˜å‡å°‘æ•°æ®åº“å‹åŠ›
- é˜…è¯»é‡ç»Ÿè®¡ä½¿ç”¨åŸå­æ“ä½œï¼Œé¿å…å¹¶å‘é—®é¢˜
- ç¼“å­˜å¤±æ•ˆç­–ç•¥ï¼šTTL + æ‰‹åŠ¨æ¸…ç†
- ç¼“å­˜å‘½ä¸­ç‡ç›‘æ§å¯è§†åŒ–
- å¼‚æ­¥ä»»åŠ¡å®šæœŸè½åº“ï¼Œé¿å…é¢‘ç¹å†™å…¥

---

## ğŸ› ï¸ å®‰è£…ä¸éƒ¨ç½²

### ä¾èµ–å®‰è£…

```bash
pip install -r requirements.txt
```


### æ•°æ®åº“è¿ç§»

```bash
python manage.py migrate
```

### å¯¼å…¥æ•°æ®

```bash
python manage.py loaddata user.json
python manage.py loaddata myblogs.json
python manage.py loaddata blogviews.json
```

### åˆ›å»ºç®¡ç†å‘˜è´¦å·ï¼ˆå¯é€‰ï¼‰

```bash
python manage.py createsuperuser
```


### è¿è¡Œå¼€å‘æœåŠ¡å™¨

```bash
python manage.py runserver
```


### å¯åŠ¨ Celery Worker

```bash
celery -A blog worker --loglevel=info
```


### å¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚ç¼“å­˜å‘½ä¸­ç‡æ—¥å¿—è¾“å‡ºï¼‰

```bash
python manage.py log_cache_stats
```

---

## ğŸ“¦ æ•°æ®æ¨¡å‹

### `Blog`
- id
- title
- content
- author (User)
- created_at

### `BlogView`
- id
- blog (å¤–é”®)
- user (å¤–é”®, å¯ä¸ºç©º)
- viewed_at

---

## ğŸ“Š æ¥å£è¯´æ˜

| è·¯å¾„ | æ–¹æ³• | æè¿° |
|------|------|------|
| `/myblogs/` | GET | æ˜¾ç¤ºæ‰€æœ‰åšå®¢åˆ—è¡¨ |
| `/myblogs/<int:blog_id>/` | GET | æŸ¥çœ‹åšå®¢è¯¦æƒ…å¹¶æ›´æ–°é˜…è¯»ç»Ÿè®¡ |
| `/myblogs/stats/` | GET | è·å–å½“å‰ç¼“å­˜å‘½ä¸­ç‡ç»Ÿè®¡ |
| `/users/register/` | POST | ç”¨æˆ·æ³¨å†Œ |
| `/users/login/` | POST | ç”¨æˆ·ç™»å½• |
| `/users/logout/` | GET | ç”¨æˆ·ç™»å‡º |

---

## ğŸ§ª æµ‹è¯•å»ºè®®

- å•å…ƒæµ‹è¯•æ”¾åœ¨å„ app çš„ `tests.py` ä¸­
- å¯ç¼–å†™ç¼“å­˜å‘½ä¸­æµ‹è¯•ã€é˜…è¯»ç»Ÿè®¡å‡†ç¡®æ€§éªŒè¯ã€ç”¨æˆ·æƒé™æµ‹è¯•ç­‰

---

## ğŸ“ ç¤ºä¾‹æˆªå›¾

### åšå®¢é¦–é¡µ
![image-20250709080505314](https://github.com/user-attachments/assets/900b9686-35b7-43ce-a1d7-5bc49db93173)

### åšå®¢è¯¦æƒ…é¡µ
![image-20250709080606851](https://github.com/user-attachments/assets/5725bd1c-30b6-448c-a178-d4c0df8b9dde)

---

## ğŸ“Œ å¾…ä¼˜åŒ–ç‚¹

- å¢åŠ å•å…ƒæµ‹è¯•è¦†ç›–ç‡
- å¢åŠ å‰ç«¯é¡µé¢äº¤äº’ä¼˜åŒ–ï¼ˆå¦‚ç‚¹èµã€è¯„è®ºï¼‰
- å¢åŠ åˆ†é¡µã€æœç´¢ã€æ ‡ç­¾ç­‰åŠŸèƒ½
- å¢åŠ  API æ¥å£ï¼ˆRESTfulï¼‰
- å¢åŠ ç¼“å­˜é™çº§ç­–ç•¥ï¼ˆå¦‚ Redis ä¸å¯ç”¨æ—¶å›é€€ DB æŸ¥è¯¢ï¼‰

---

## âœ… æ€»ç»“

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå…¸å‹çš„ **å‰åç«¯åˆ†ç¦»å¼ Django åº”ç”¨**ï¼Œé›†æˆäº†ç¼“å­˜ã€å¼‚æ­¥ä»»åŠ¡ã€æƒé™æ§åˆ¶ç­‰ç°ä»£ Web å¼€å‘å¸¸ç”¨æŠ€æœ¯ã€‚é€‚åˆç”¨äºæ•™å­¦ã€ç»ƒæ‰‹æˆ–ä½œä¸ºä¼ä¸šçº§åšå®¢ç³»ç»Ÿçš„åŸå‹æ¡†æ¶ã€‚
